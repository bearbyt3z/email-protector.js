{"version":3,"file":"email-protector.js","mappings":"mBACA,IAAIA,EAAsB,CCA1BA,EAAwB,CAACC,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXF,EAAoBI,EAAEF,EAAYC,KAASH,EAAoBI,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDH,EAAwB,CAACS,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFV,EAAyBC,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,GAAO,G,0CCL9D,IAAMC,EAAQ,CAEZC,YAAa,wIACbC,SAAU,SAACH,GAAK,MAAsB,iBAAVA,GAAsBA,aAAiBI,MAAM,EACzEC,aAAc,SAACC,GAAG,OAAM,IAAIC,OAAO,IAADC,OAAKP,EAAMC,YAAYO,OAAM,MAAMC,KAAKN,OAAOE,GAAK,EACtFK,aAAc,SAACL,GAAG,OAAKF,OAAOE,GAAKM,QAAQ,wBAAyB,OAAO,EAC3EC,cAAe,SAACP,GAAG,OAAKF,OAAOE,GAAKQ,MAAM,IAAIC,UAAUC,KAAK,GAAG,EAChEC,gBAAiB,eAACC,EAAMC,UAAAD,OAAA,QAAAE,IAAAD,UAAA,GAAAA,UAAA,GAAG,EAAGE,EAAOF,UAAAD,OAAA,QAAAE,IAAAD,UAAA,GAAAA,UAAA,GAAG,6BAA4B,OAAKG,MAAMC,KAAK,CAAEL,OAAAA,IAAU,kBAAMG,EAAQG,KAAKC,MAAMD,KAAKE,SAAWL,EAAQH,QAAQ,IAAEF,KAAK,GAAG,EACnKW,eAAgB,oBAAAnB,OAASP,EAAMgB,gBAAgB,GAAE,KAAAT,OAAIP,EAAMgB,gBAAgB,IAAG,KAAAT,OAAIP,EAAMgB,gBAAgB,GAAE,EAC1GW,UAAW,qBAAApB,OAAUqB,KAAKC,MAAMC,SAAS,IAAMP,KAAKE,SAASK,SAAS,IAAIC,UAAU,GAAE,GAGxF,U,gyCCTA,IAAMC,EAAS,CAAC,EAEHC,EAAiB,CAC5BC,cAAe,CACbC,KAAM,GACNC,YAAY,EACZC,YAAY,EACZC,cAAc,GAEhBC,OAAQ,CAAC,EACTC,OAAQ,CAAC,EAETC,IAAK,SAACpC,GAAG,IAAE8B,EAAIjB,UAAAD,OAAA,QAAAE,IAAAD,UAAA,GAAAA,UAAA,GAAG,GAAE,OAAKf,OAAOE,GAAKM,QAAQ,WAAW,SAAC+B,GACvD,IAAMC,EAAaD,GAAQ,IAAM,GAAK,IAChCE,EAAYF,EAAKG,WAAW,GAAMV,EAAO,GAC/C,OAAOhC,OAAO2C,aAAcF,GAAaD,EAAcC,EAAYA,EAAY,GACjF,GAAE,EACFG,OAAQ,SAACC,GAAuC,IAA7BR,EAAMtB,UAAAD,OAAA,QAAAE,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAGqB,EAAMrB,UAAAD,OAAA,QAAAE,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EAClC+B,EAAiBjB,EAAOkB,cAAcV,GACtCW,EAAiBnB,EAAOoB,cAAcb,GAC5Cc,OAAOC,iBAAiB,QAAQ,WAC9B,IAAMC,EAAaC,SAASC,eAAeT,GAC3C,IAAKO,EACH,MAAM,IAAIG,UAAU,gCAADnD,OAAiCyC,EAAQ,kBAE9D,IAAMW,EAAWH,SAASI,cAAc,KACxCD,EAASE,GAAKC,EAAMnC,YACpB4B,EAAWQ,YAAYJ,GACvB3B,EAAOgC,UAAUL,EAASE,GAAIZ,EAAgBE,EAChD,GACF,EACAc,MAAO,WAA8B,IAA7BzB,EAAMtB,UAAAD,OAAA,QAAAE,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAGqB,EAAMrB,UAAAD,OAAA,QAAAE,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EACvB+B,EAAiBjB,EAAOkB,cAAcV,GACtCW,EAAiBnB,EAAOoB,cAAcb,GACtC2B,EAASJ,EAAMnC,YACrB6B,SAASS,MAAM,UAAD1D,OAAW2D,EAAM,WAC/BlC,EAAOgC,UAAUE,EAAQjB,EAAgBE,EAC3C,EACAgB,gBAAiB,SAAC3B,GAChBP,EAAeO,OAAS,CAAC,EACzBP,EAAeO,OAASR,EAAOkB,cAAcV,EAC/C,EACA4B,gBAAiB,SAAC7B,GAChBN,EAAeM,OAAS,CAAC,EACzBN,EAAeM,OAASP,EAAOoB,cAAcb,EAC/C,EACA8B,YAAa,WAAQpC,EAAeO,OAAS,CAAC,CAAG,EACjD8B,YAAa,kBAAMlF,OAAOmF,OAAOtC,EAAeM,OAAQN,EAAeC,cAAc,EACrFsC,OAAQ,SAACC,EAAOtC,GACd,I,IAAMuC,EAAcD,GAASpB,OAAOoB,MAC9BE,EAASD,EAAYC,QAAUD,EAAYE,WAQjD,OAPKD,EAAOE,QAAQC,eAClBH,EAAOI,KAAOJ,EAAOI,KAAKpE,QACxB,IAAIL,OAAOH,OAAO6E,IAAGC,I,EAAA,4B,EAAA,gC,cAAAA,E,0EAAoBnB,EAAM7D,YAAYO,QAAY,OACvE,SAAC0E,GAAK,OAAKjD,EAAeQ,IAAIyC,EAAO/C,EAAK,IAE5CwC,EAAOE,QAAQC,cAAe,IAEzB,CACT,GAGF9C,EAAOkB,cAAgB,SAACV,GACtB,IAAI2C,EAAiB3C,EAIrB,GAHIsB,EAAM5D,SAASiF,KACjBA,EAAiB,CAAEC,MAAOD,MAEtBA,aAA0B/F,QAC9B,MAAM,IAAIsE,UAAU,0DAGtB,GADAyB,EAAcE,EAAAA,EAAA,GAAQpD,EAAeO,QAAW2C,IAC3CrB,EAAM1D,aAAa+E,EAAeC,OACrC,MAAM,IAAI1B,UAAU,mBAADnD,OAAoB4E,EAAeC,MAAK,kCAE7D,OAAOD,CACT,EAEAnD,EAAOoB,cAAgB,SAACb,GAAM,OAAA8C,EAAAA,EAAAA,EAAA,GACzBpD,EAAeC,eACfD,EAAeM,QACdA,aAAkBnD,OAASmD,EAAS,CAAC,EAAC,EAG5CP,EAAOgC,UAAY,SAACE,EAAQ1B,EAAQD,GAClC,IAAMJ,EAAOI,EAAOJ,KAAO,GACrBmD,EAAgB9B,SAAS+B,yBAC/B,GAAIhD,EAAOiD,UACTF,EAAcvB,YAAYP,SAASiC,eAAelD,EAAOiD,gBACpD,CACL,IAAIE,EAAWzD,EAAeQ,IAAID,EAAO4C,MAAOjD,GAC1CwD,EAAc7B,EAAMpC,iBACpBkE,EAAYpC,SAASI,cAAc,SACrCrB,EAAOH,aACTsD,EAAW5B,EAAMlD,cAAc8E,GAC/BE,EAAU7B,YAAYP,SAASiC,eAAe,cAADlF,OACxC2D,EAAM,+FAMb,IAAM2B,EAAerC,SAASiC,eAAeC,GAE7C,GADAJ,EAAcvB,YAAY8B,GACtBtD,EAAOF,WAAY,CACrB,IAAMA,EAAamB,SAASI,cAAc,QAC1CvB,EAAW0B,YAAYP,SAASiC,eAAeE,IAC/CL,EAAcQ,aAAazD,EAAYwD,EAAaE,UAAUL,EAASM,QAAQ,OAC/EJ,EAAU7B,YAAYP,SAASiC,eAAe,cAADlF,OACxC2D,EAAM,yDAIb,CACI3B,EAAOD,eAETjB,MAAMC,KAAKgE,EAAcW,YAAYC,SAAQ,SAACC,GAC5CnE,EAAOoE,2BAA2BD,EAAM,CAAC,IAAK,KAChD,IACAb,EAAcQ,aAAatC,SAAS6C,cAAc,WAAD9F,OAAYoF,EAAW,MAAML,EAAcgB,aAE1FV,EAAUU,YAAY9C,SAAS+C,KAAKxC,YAAY6B,EACtD,CAEA,IAAMY,EAAkBvE,EAAeQ,IAAI,UAAW,GAAKN,GACrDsE,EAAkBzE,EAAO0E,uBAAuBlE,GAChDmB,EAAWH,SAASC,eAAeS,GACzCP,EAASoB,KAAO,GAAHxE,OAAMiG,GAAejG,OAAGiC,EAAO4C,OAAK7E,OAAGkG,GACpD9C,EAASI,YAAYuB,GACrB3B,EAASL,iBAAiB,aAAa,SAACmB,GAAK,OAAKxC,EAAeuC,OAAOC,EAAOtC,EAAK,GACtF,EAEAH,EAAOoE,2BAA6B,SAACD,EAAMQ,GACzC,GAAIR,EAAKS,WAAaC,KAAKC,UAAW,OAAO,EAC7C,IAAMC,EAAqB,GAAGxG,OAAOoG,GAC/BK,EAAe,IAAI1G,OAAOyG,EAAmBE,KAAI,SAAC5G,GAAG,OAAKyD,EAAMpD,aAAaL,EAAI,IAAEU,KAAK,KAAM,KAC9FmG,EAAUf,EAAKgB,YAAYjC,MAAM8B,IAAiB,GACpDI,EAAcjB,EAalB,OAZAe,EAAQhB,SAAQ,SAAC7F,GACf,IAAMgH,EAAa7D,SAAS6C,cAAc,QAAD9F,OAASF,EAAG,MAC/CiH,EAAc9D,SAAS6C,cAAc,SAAD9F,OAAUF,EAAG,MACjDkH,EAASH,EAAYD,YAAYnB,QAAQ3F,GAC/C,GAAIkH,GAAU,EAAG,CACf,IAAMC,EAAWJ,EAAYrB,UAAUwB,GACvCH,EAAY7D,WAAWuC,aAAauB,EAAYG,GAChD,IAAMC,EAAgBD,EAASzB,UAAU1F,EAAIY,QAC7CmG,EAAY7D,WAAWuC,aAAawB,EAAaG,GACjDL,EAAcK,CAChB,CACF,KACO,CACT,EAEAzF,EAAO0E,uBAAyB,SAAClE,GAC/B,IAAMkF,EAAStI,OAAOuI,QAAQnF,GAAQoF,QAAO,SAACC,EAAGC,GAAA,I,IAAAC,G,EAAE,E,4CAAFD,I,s1BAAG5I,EAAG6I,EAAA,GAAEhI,EAAKgI,EAAA,UAAO7I,EAAIgG,MAAM,2BAA6B,GAAH3E,OAAMsH,EAAG,KAAAtH,OAAIrB,EAAG,KAAAqB,OAAIyH,mBAAmBjI,IAAW8H,CAAG,GAAG,IACjK,OAAQH,EAAOzG,OAAS,EAAC,IAAAV,OAAQmH,EAAO3F,UAAU,IAAO,EAC3D,E","sources":["webpack://email-protector.js/webpack/bootstrap","webpack://email-protector.js/webpack/runtime/define property getters","webpack://email-protector.js/webpack/runtime/hasOwnProperty shorthand","webpack://email-protector.js/webpack/runtime/make namespace object","webpack://email-protector.js/./src/tools.js","webpack://email-protector.js/./src/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const Tools = {\n  // email regular expression via MDN Web Docs => https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/email#basic_validation\n  emailRegExp: /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/,\n  isString: (value) => typeof value === 'string' || value instanceof String,\n  isValidEmail: (str) => (new RegExp(`^${Tools.emailRegExp.source}$`)).test(String(str)),\n  regExpEscape: (str) => String(str).replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&'),\n  reverseString: (str) => String(str).split('').reverse().join(''),\n  getRandomString: (length = 8, charset = 'abcdefghijklmnopqrstuvwxyz') => Array.from({ length }, () => charset[Math.floor(Math.random() * charset.length)]).join(''),\n  getRandomEmail: () => `${Tools.getRandomString(6)}@${Tools.getRandomString(10)}.${Tools.getRandomString(3)}`,\n  getUniqID: () => `_${Date.now().toString(36) + Math.random().toString(36).substring(2)}`,\n};\n\nexport default Tools;\n","/* eslint-disable import/prefer-default-export */\nimport tools from './tools';\n\nconst Helper = {};  // Helper functions (defined later)\n\nexport const EmailProtector = {\n  defaultConfig: {\n    code: 13,\n    cssReverse: true,\n    hiddenSpan: true,\n    htmlComments: true,\n  },\n  config: {},\n  params: {},\n\n  rot: (str, code = 13) => String(str).replace(/[a-z]/gi, (char) => {\n    const upperLimit = char <= 'Z' ? 90 : 122;\n    const rotedChar = char.charCodeAt(0) + (code % 26);\n    return String.fromCharCode((rotedChar <= upperLimit) ? rotedChar : rotedChar - 26);\n  }),\n  append: (parentID, params = {}, config = {}) => {\n    const paramsPrepared = Helper.prepareParams(params);\n    const configPrepared = Helper.prepareConfig(config);\n    window.addEventListener('load', () => {\n      const parentNode = document.getElementById(parentID);\n      if (!parentNode) {\n        throw new TypeError(`EmailProtector: element with ${parentID} ID not found`);\n      }\n      const linkNode = document.createElement('A');\n      linkNode.id = tools.getUniqID();\n      parentNode.appendChild(linkNode);\n      Helper.setupLink(linkNode.id, paramsPrepared, configPrepared);\n    });\n  },\n  write: (params = {}, config = {}) => {\n    const paramsPrepared = Helper.prepareParams(params);\n    const configPrepared = Helper.prepareConfig(config);\n    const uniqID = tools.getUniqID();\n    document.write(`<a id=\"${uniqID}\"></a>`);\n    Helper.setupLink(uniqID, paramsPrepared, configPrepared);\n  },\n  setGlobalParams: (params) => {\n    EmailProtector.params = {};  // _prepareParams() use this value, so we have to reset it first\n    EmailProtector.params = Helper.prepareParams(params);\n  },\n  setGlobalConfig: (config) => {\n    EmailProtector.config = {};  // _prepareConfig() use this value, so we have to reset it first\n    EmailProtector.config = Helper.prepareConfig(config);\n  },\n  resetParams: () => { EmailProtector.params = {}; },\n  resetConfig: () => Object.assign(EmailProtector.config, EmailProtector.defaultConfig),\n  decode: (event, code) => {\n    const properEvent = event || window.event;\n    const target = properEvent.target || properEvent.srcElement;\n    if (!target.dataset.emailDecoded) {\n      target.href = target.href.replace(\n        new RegExp(String.raw`\\b([a-zA-Z]{6}:)?${tools.emailRegExp.source}\\b`, 'gi'),\n        (match) => EmailProtector.rot(match, code),\n      );\n      target.dataset.emailDecoded = true;\n    }\n    return true;\n  },\n};\n\nHelper.prepareParams = (params) => {\n  let preparedParams = params;\n  if (tools.isString(preparedParams)) {  // allow to pass an email address as a string only\n    preparedParams = { email: preparedParams };\n  }\n  if (!(preparedParams instanceof Object)) {\n    throw new TypeError('EmailProtector: params should be a string or an object');\n  }\n  preparedParams = { ...EmailProtector.params, ...preparedParams };\n  if (!tools.isValidEmail(preparedParams.email)) {\n    throw new TypeError(`EmailProtector: ${preparedParams.email} is not a valid email address`);\n  }\n  return preparedParams;\n};\n\nHelper.prepareConfig = (config) => ({\n  ...EmailProtector.defaultConfig,\n  ...EmailProtector.config,\n  ...(config instanceof Object ? config : {}),\n});\n\nHelper.setupLink = (uniqID, params, config) => {\n  const code = config.code % 26;  // for code numbers greater than 26\n  const linkContainer = document.createDocumentFragment();\n  if (config.linkLabel) {\n    linkContainer.appendChild(document.createTextNode(config.linkLabel));\n  } else {\n    let linkText = EmailProtector.rot(params.email, code);\n    const randomEmail = tools.getRandomEmail();\n    const styleNode = document.createElement('STYLE');\n    if (config.cssReverse) {\n      linkText = tools.reverseString(linkText);\n      styleNode.appendChild(document.createTextNode(`\n        #${uniqID} {\n          unicode-bidi: bidi-override;\n          direction: rtl;\n        }\n      `));\n    }\n    const linkTextNode = document.createTextNode(linkText);\n    linkContainer.appendChild(linkTextNode);\n    if (config.hiddenSpan) {\n      const hiddenSpan = document.createElement('span');\n      hiddenSpan.appendChild(document.createTextNode(randomEmail));\n      linkContainer.insertBefore(hiddenSpan, linkTextNode.splitText(linkText.indexOf('@')));\n      styleNode.appendChild(document.createTextNode(`\n        #${uniqID} span {\n          display: none;\n        }\n      `));\n    }\n    if (config.htmlComments) {\n      // Array.from to get static list => childNodes would change due to splitText()\n      Array.from(linkContainer.childNodes).forEach((node) => {\n        Helper.extendTextNodeWithComments(node, ['@', '.']);\n      });\n      linkContainer.insertBefore(document.createComment(` mailto:${randomEmail} `), linkContainer.firstChild);\n    }\n    if (styleNode.firstChild) document.head.appendChild(styleNode);\n  }\n\n  const mailtoEncrypted = EmailProtector.rot('mailto:', 26 - code);\n  const emailLinkParams = Helper.prepareEmailLinkParams(params);\n  const linkNode = document.getElementById(uniqID);\n  linkNode.href = `${mailtoEncrypted}${params.email}${emailLinkParams}`;\n  linkNode.appendChild(linkContainer);\n  linkNode.addEventListener('mousedown', (event) => EmailProtector.decode(event, code));\n};\n\nHelper.extendTextNodeWithComments = (node, searchStrings) => {\n  if (node.nodeType !== Node.TEXT_NODE) return false;\n  const searchStringsArray = [].concat(searchStrings);  // ensure it's an array\n  const searchRegExp = new RegExp(searchStringsArray.map((str) => tools.regExpEscape(str)).join('|'), 'g');\n  const matches = node.textContent.match(searchRegExp) || [];  // [] => in case no match is found\n  let currentNode = node;\n  matches.forEach((str) => {\n    const preComment = document.createComment(` pre ${str} `);\n    const postComment = document.createComment(` post ${str} `);\n    const strPos = currentNode.textContent.indexOf(str);\n    if (strPos >= 0) {\n      const strSplit = currentNode.splitText(strPos);\n      currentNode.parentNode.insertBefore(preComment, strSplit);\n      const strSplitAfter = strSplit.splitText(str.length);\n      currentNode.parentNode.insertBefore(postComment, strSplitAfter);\n      currentNode = strSplitAfter;\n    }\n  });\n  return true;\n};\n\nHelper.prepareEmailLinkParams = (params) => {\n  const result = Object.entries(params).reduce((acc, [key, value]) => (key.match(/^cc|bcc|subject|body$/gi) ? `${acc}&${key}=${encodeURIComponent(value)}` : acc), '');\n  return (result.length > 0) ? `?${result.substring(1)}` : '';\n};\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","Tools","emailRegExp","isString","String","isValidEmail","str","RegExp","concat","source","test","regExpEscape","replace","reverseString","split","reverse","join","getRandomString","length","arguments","undefined","charset","Array","from","Math","floor","random","getRandomEmail","getUniqID","Date","now","toString","substring","Helper","EmailProtector","defaultConfig","code","cssReverse","hiddenSpan","htmlComments","config","params","rot","char","upperLimit","rotedChar","charCodeAt","fromCharCode","append","parentID","paramsPrepared","prepareParams","configPrepared","prepareConfig","window","addEventListener","parentNode","document","getElementById","TypeError","linkNode","createElement","id","tools","appendChild","setupLink","write","uniqID","setGlobalParams","setGlobalConfig","resetParams","resetConfig","assign","decode","event","properEvent","target","srcElement","dataset","emailDecoded","href","raw","_templateObject","match","preparedParams","email","_objectSpread","linkContainer","createDocumentFragment","linkLabel","createTextNode","linkText","randomEmail","styleNode","linkTextNode","insertBefore","splitText","indexOf","childNodes","forEach","node","extendTextNodeWithComments","createComment","firstChild","head","mailtoEncrypted","emailLinkParams","prepareEmailLinkParams","searchStrings","nodeType","Node","TEXT_NODE","searchStringsArray","searchRegExp","map","matches","textContent","currentNode","preComment","postComment","strPos","strSplit","strSplitAfter","result","entries","reduce","acc","_ref","_ref2","encodeURIComponent"],"sourceRoot":""}